# 完整的校园约伴系统接口文档（枚举优化版）

## 文档说明
- **基础URL**：`http://localhost:8080/api/v1`（开发环境）
- **生产环境**：`https://api.mi.com/api/v1`
- **数据格式**：JSON
- **认证方式**：JWT Token（需在请求头中携带 `Authorization: Bearer {token}`）
- **版本**：v1

## 通用响应格式

### 成功响应
```json
{
  "code": 200,
  "message": "成功",
  "data": {}, // 实际数据
  "timestamp": 1640995200000
}
```

### 错误响应
```json
{
  "code": 400,
  "message": "错误描述",
  "data": null,
  "timestamp": 1640995200000
}
```

## HTTP状态码说明
| 状态码 | 说明         |
| ------ | ------------ |
| 200    | 成功         |
| 400    | 请求参数错误 |
| 401    | 未授权       |
| 403    | 无权限       |
| 404    | 资源不存在   |
| 500    | 服务器内部错误 |

---

## 1. 用户认证模块（AUTH）

### 1.1 用户登录
- **接口说明**：用户使用学号/邮箱和密码登录
- **请求路径**：`POST /auth/login`
- **请求参数**：

| 参数名       | 类型   | 必填 | 说明         |
| ------------ | ------ | ---- | ------------ |
| identifier   | string | 是   | 学号或邮箱   |
| password     | string | 是   | 密码         |

- **请求示例**：
```json
{
  "identifier": "1120231148",
  "password": "123456"
}
```

- **响应示例**：
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": 1,
      "email": "test@example.com",
      "nickname": "张三",
      "avatarUrl": "http://example.com/avatar.jpg",
      "userType": 0
    }
  },
  "timestamp": 1640995200000
}
```

### 1.2 用户注册
- **接口说明**：新用户注册
- **请求路径**：`POST /auth/register`
- **请求参数**：

| 参数名   | 类型   | 必填 | 说明     |
| -------- | ------ | ---- | -------- |
| email    | string | 是   | 邮箱     |
| password | string | 是   | 密码     |
| nickname | string | 是   | 昵称     |
| studentId| string | 否   | 学号     |

- **请求示例**：
```json
{
  "email": "test@example.com",
  "password": "123456",
  "nickname": "张三",
  "studentId": "1120231148"
}
```

- **响应示例**：
```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "userId": 1
  },
  "timestamp": 1640995200000
}
```

### 1.3 刷新Token
- **接口说明**：使用refreshToken刷新访问令牌
- **请求路径**：`POST /auth/refresh`
- **请求参数**：

| 参数名       | 类型   | 必填 | 说明         |
| ------------ | ------ | ---- | ------------ |
| refreshToken | string | 是   | 刷新令牌     |

- **响应示例**：
```json
{
  "code": 200,
  "message": "刷新成功",
  "data": {
    "token": "新的访问令牌"
  },
  "timestamp": 1640995200000
}
```

### 1.4 退出登录
- **接口说明**：用户退出登录
- **请求路径**：`POST /auth/logout`
- **请求头**：需要携带token
- **响应示例**：
```json
{
  "code": 200,
  "message": "退出成功",
  "data": null,
  "timestamp": 1640995200000
}
```

---

## 2. 用户管理模块（USER）

### 2.1 获取用户详情
- **接口说明**：根据用户ID获取用户详细信息
- **请求路径**：`GET /users/{userId}`
- **路径参数**：

| 参数名 | 类型 | 必填 | 说明   |
| ------ | ---- | ---- | ------ |
| userId | int  | 是   | 用户ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 1,
    "email": "test@example.com",
    "nickname": "张三",
    "avatarUrl": "http://example.com/avatar.jpg",
    "signature": "个性签名",
    "userType": 0,
    "createdAt": "2023-01-01 12:00:00"
  },
  "timestamp": 1640995200000
}
```

### 2.2 更新用户信息
- **接口说明**：更新用户基本信息（昵称、头像、个性签名）
- **请求路径**：`PUT /users/{userId}`
- **路径参数**：

| 参数名 | 类型 | 必填 | 说明   |
| ------ | ---- | ---- | ------ |
| userId | int  | 是   | 用户ID |

- **请求参数**：

| 参数名    | 类型   | 必填 | 说明     |
| --------- | ------ | ---- | -------- |
| nickname  | string | 否   | 昵称     |
| avatarUrl | string | 否   | 头像URL  |
| signature | string | 否   | 个性签名 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": 1,
    "nickname": "新昵称",
    "avatarUrl": "http://example.com/new_avatar.jpg",
    "signature": "新签名"
  },
  "timestamp": 1640995200000
}
```

### 2.3 修改密码
- **接口说明**：修改登录密码
- **请求路径**：`PUT /users/{userId}/password`
- **路径参数**：

| 参数名 | 类型 | 必填 | 说明   |
| ------ | ---- | ---- | ------ |
| userId | int  | 是   | 用户ID |

- **请求参数**：

| 参数名      | 类型   | 必填 | 说明   |
| ----------- | ------ | ---- | ------ |
| oldPassword | string | 是   | 旧密码 |
| newPassword | string | 是   | 新密码 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "密码修改成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 2.4 上传头像
- **接口说明**：上传用户头像图片
- **请求路径**：`POST /users/{userId}/avatar`
- **请求方式**：`multipart/form-data`
- **路径参数**：

| 参数名 | 类型 | 必填 | 说明   |
| ------ | ---- | ---- | ------ |
| userId | int  | 是   | 用户ID |

- **请求参数**：

| 参数名 | 类型 | 必填 | 说明     |
| ------ | ---- | ---- | -------- |
| avatar | file | 是   | 头像文件 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "avatarUrl": "http://example.com/upload/avatar_1.jpg"
  },
  "timestamp": 1640995200000
}
```

### 2.5 搜索用户
- **接口说明**：根据关键词搜索用户（昵称或学号）
- **请求路径**：`GET /users/search`
- **查询参数**：

| 参数名  | 类型   | 必填 | 说明         |
| ------- | ------ | ---- | ------------ |
| keyword | string | 是   | 搜索关键词   |
| page    | int    | 否   | 页码，默认1  |
| size    | int    | 否   | 每页数量，默认10 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 1,
        "nickname": "张三",
        "avatarUrl": "http://example.com/avatar.jpg",
        "studentId": "1120231148"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 10
  },
  "timestamp": 1640995200000
}
```

---

## 3. 预约订单模块（ORDER）

### 3.1 发布预约订单
- **接口说明**：用户发布一个新的预约订单
- **请求路径**：`POST /orders`
- **请求参数**：

| 字段名         | 类型          | 必填 | 说明                                       |
| -------------- | ------------- | ---- | ------------------------------------------ |
| activityType   | ActivityType  | 是   | 活动类型                                   |
| genderRequire  | GenderType    | 是   | 性别要求                                   |
| campus         | CampusType    | 是   | 校区                                       |
| location       | string        | 是   | 活动地点                                   |
| startTime      | string        | 是   | 活动开始时间，格式：yyyy-MM-dd HH:mm:ss    |
| note           | string        | 否   | 备注                                       |
| maxPeople      | int           | 是   | 需要的人数上限                             |

- **请求示例**：
```json
{
  "activityType": 1,
  "genderRequire": 2,
  "campus": 0,
  "location": "天街海底捞",
  "startTime": "2024-03-15 18:30:00",
  "note": "找人一起吃火锅，AA制",
  "maxPeople": 4
}
```

- **响应示例**：
```json
{
  "code": 200,
  "message": "发布成功",
  "data": {
    "orderId": 1001
  },
  "timestamp": 1640995200000
}
```

### 3.2 获取订单列表
- **接口说明**：分页获取订单列表，支持多条件筛选
- **请求路径**：`GET /orders`
- **查询参数**：

| 参数名       | 类型         | 必填 | 说明                                      |
| ------------ | ------------ | ---- | ----------------------------------------- |
| page         | int          | 否   | 页码，默认1                               |
| size         | int          | 否   | 每页数量，默认10                          |
| status       | OrderStatus  | 否   | 订单状态                                  |
| activityType | ActivityType | 否   | 活动类型                                  |
| campus       | CampusType   | 否   | 校区                                      |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 1001,
        "user": {
          "id": 1,
          "nickname": "张三",
          "avatarUrl": "http://example.com/avatar.jpg"
        },
        "activityType": 1,
        "campus": 0,
        "location": "天街海底捞",
        "startTime": "2024-03-15 18:30:00",
        "note": "找人一起吃火锅，AA制",
        "maxPeople": 4,
        "currentPeople": 1,
        "status": 0,
        "createdAt": "2024-03-10 10:00:00"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 10
  },
  "timestamp": 1640995200000
}
```

### 3.3 获取订单详情
- **接口说明**：根据订单ID获取订单详细信息，包括申请人列表
- **请求路径**：`GET /orders/{orderId}`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "order": {
      "id": 1001,
      "user": {
        "id": 1,
        "nickname": "张三",
        "avatarUrl": "http://example.com/avatar.jpg"
      },
      "activityType": 1,
      "genderRequire": 2,
      "campus": 0,
      "location": "天街海底捞",
      "startTime": "2024-03-15 18:30:00",
      "note": "找人一起吃火锅，AA制",
      "maxPeople": 4,
      "currentPeople": 1,
      "status": 0,
      "createdAt": "2024-03-10 10:00:00"
    },
    "applications": [
      {
        "id": 2001,
        "user": {
          "id": 2,
          "nickname": "李四",
          "avatarUrl": "http://example.com/avatar2.jpg"
        },
        "status": 0,
        "createdAt": "2024-03-10 11:00:00"
      }
    ]
  },
  "timestamp": 1640995200000
}
```

### 3.4 修改订单信息
- **接口说明**：订单发布者修改订单信息
- **请求路径**：`PUT /orders/{orderId}`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **请求参数**：同发布订单，但所有字段可选，只传需要修改的字段
- **响应示例**：
```json
{
  "code": 200,
  "message": "修改成功",
  "data": {
    "orderId": 1001
  },
  "timestamp": 1640995200000
}
```

### 3.5 删除订单
- **接口说明**：订单发布者删除订单（逻辑删除）
- **请求路径**：`DELETE /orders/{orderId}`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 3.6 完成订单
- **接口说明**：订单发布者标记订单为已完成
- **请求路径**：`PUT /orders/{orderId}/complete`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "订单已完成",
  "data": null,
  "timestamp": 1640995200000
}
```

### 3.7 申请加入订单
- **接口说明**：用户申请加入某个订单
- **请求路径**：`POST /orders/{orderId}/apply`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **请求参数**：

| 参数名  | 类型   | 必填 | 说明         |
| ------- | ------ | ---- | ------------ |
| message | string | 否   | 申请留言     |

- **响应示例**：
```json
{
  "code": 200,
  "message": "申请成功",
  "data": {
    "applyId": 2001
  },
  "timestamp": 1640995200000
}
```

### 3.8 取消申请
- **接口说明**：用户取消自己对某个订单的申请
- **请求路径**：`DELETE /orders/{orderId}/apply`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "取消成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 3.9 获取申请列表
- **接口说明**：订单发布者获取该订单的所有申请记录
- **请求路径**：`GET /orders/{orderId}/applications`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 2001,
      "user": {
        "id": 2,
        "nickname": "李四",
        "avatarUrl": "http://example.com/avatar2.jpg"
      },
      "message": "我想加入",
      "status": 0,
      "createdAt": "2024-03-10 11:00:00"
    }
  ],
  "timestamp": 1640995200000
}
```

### 3.10 审核申请
- **接口说明**：订单发布者审核用户的申请（通过或拒绝）
- **请求路径**：`PUT /orders/applications/{applyId}`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明     |
| ------- | ---- | ---- | -------- |
| applyId | int  | 是   | 申请记录ID |

- **请求参数**：

| 参数名 | 类型        | 必填 | 说明                     |
| ------ | ----------- | ---- | ------------------------ |
| status | ApplyStatus | 是   | 审核状态                 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "审核成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 3.11 接受订单
- **接口说明**：订单发布者确定最终接受哪个用户加入订单
- **请求路径**：`POST /orders/{orderId}/accept`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **请求参数**：

| 参数名     | 类型 | 必填 | 说明         |
| ---------- | ---- | ---- | ------------ |
| accepterId | int  | 是   | 被接受的用户ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "接受成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 3.12 发送订单消息
- **接口说明**：用户向订单发布者发送问询消息
- **请求路径**：`POST /orders/{orderId}/messages`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **请求参数**：

| 参数名  | 类型   | 必填 | 说明     |
| ------- | ------ | ---- | -------- |
| content | string | 是   | 消息内容 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "发送成功",
  "data": {
    "messageId": 3001
  },
  "timestamp": 1640995200000
}
```

### 3.13 获取订单消息
- **接口说明**：获取订单相关的聊天记录
- **请求路径**：`GET /orders/{orderId}/messages`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **查询参数**：

| 参数名 | 类型 | 必填 | 说明         |
| ------ | ---- | ---- | ------------ |
| page   | int  | 否   | 页码，默认1  |
| size   | int  | 否   | 每页数量，默认20 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 3001,
        "sender": {
          "id": 2,
          "nickname": "李四",
          "avatarUrl": "http://example.com/avatar2.jpg"
        },
        "receiver": {
          "id": 1,
          "nickname": "张三",
          "avatarUrl": "http://example.com/avatar.jpg"
        },
        "content": "可以改时间吗？",
        "createdAt": "2024-03-10 12:00:00"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 20
  },
  "timestamp": 1640995200000
}
```

---

## 4. 动态（帖子）管理模块（CONTENT）

### 4.1 发布动态
- **接口说明**：用户发布一条动态（可关联订单）
- **请求路径**：`POST /contents`
- **请求参数**：

| 参数名    | 类型        | 必填 | 说明                                     |
| --------- | ----------- | ---- | ---------------------------------------- |
| content   | string      | 是   | 动态文本内容                             |
| mediaType | MediaType   | 否   | 媒体类型，默认TEXT                       |
| orderId   | int         | 否   | 关联的订单ID                             |

- **请求示例**：
```json
{
  "content": "今天打球很开心！",
  "mediaType": 1,
  "orderId": 1001
}
```

- **响应示例**：
```json
{
  "code": 200,
  "message": "发布成功",
  "data": {
    "contentId": 4001
  },
  "timestamp": 1640995200000
}
```

### 4.2 获取动态列表
- **接口说明**：分页获取动态列表
- **请求路径**：`GET /contents`
- **查询参数**：

| 参数名 | 类型         | 必填 | 说明                     |
| ------ | ------------ | ---- | ------------------------ |
| page   | int          | 否   | 页码，默认1              |
| size   | int          | 否   | 每页数量，默认10         |
| type   | ContentType  | 否   | 内容类型                 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 4001,
        "user": {
          "id": 1,
          "nickname": "张三",
          "avatarUrl": "http://example.com/avatar.jpg"
        },
        "content": "今天打球很开心！",
        "mediaType": 1,
        "order": {
          "id": 1001,
          "activityType": 1
        },
        "likeCount": 10,
        "commentCount": 5,
        "createdAt": "2024-03-10 14:00:00"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 10
  },
  "timestamp": 1640995200000
}
```

### 4.3 获取动态详情
- **接口说明**：根据动态ID获取动态详细信息，包括评论和点赞数
- **请求路径**：`GET /contents/{contentId}`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明     |
| --------- | ---- | ---- | -------- |
| contentId | int  | 是   | 动态ID   |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 4001,
    "user": {
      "id": 1,
      "nickname": "张三",
      "avatarUrl": "http://example.com/avatar.jpg"
    },
    "content": "今天打球很开心！",
    "mediaType": 1,
    "order": {
      "id": 1001,
      "activityType": 1
    },
    "media": [
      {
        "id": 5001,
        "mediaType": 1,
        "url": "http://example.com/image.jpg"
      }
    ],
    "likeCount": 10,
    "commentCount": 5,
    "createdAt": "2024-03-10 14:00:00"
  },
  "timestamp": 1640995200000
}
```

### 4.4 删除动态
- **接口说明**：删除动态（发布者或管理员）
- **请求路径**：`DELETE /contents/{contentId}`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明     |
| --------- | ---- | ---- | -------- |
| contentId | int  | 是   | 动态ID   |

- **响应示例**：
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 4.5 上传媒体文件
- **接口说明**：为动态上传图片或视频
- **请求路径**：`POST /contents/{contentId}/media`
- **请求方式**：`multipart/form-data`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明   |
| --------- | ---- | ---- | ------ |
| contentId | int  | 是   | 动态ID |

- **请求参数**：

| 参数名 | 类型 | 必填 | 说明         |
| ------ | ---- | ---- | ------------ |
| media  | file | 是   | 图片或视频文件 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "mediaUrl": "http://example.com/upload/image_4001.jpg"
  },
  "timestamp": 1640995200000
}
```

### 4.6 发布评论
- **接口说明**：对动态或评论进行回复
- **请求路径**：`POST /contents/{contentId}/comments`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明   |
| --------- | ---- | ---- | ------ |
| contentId | int  | 是   | 动态ID |

- **请求参数**：

| 参数名   | 类型   | 必填 | 说明                         |
| -------- | ------ | ---- | ---------------------------- |
| content  | string | 是   | 评论内容                     |
| parentId | int    | 否   | 父评论ID，为空则表示回复动态 |

- **请求示例**：
```json
{
  "content": "评论内容",
  "parentId": 4002
}
```

- **响应示例**：
```json
{
  "code": 200,
  "message": "评论成功",
  "data": {
    "commentId": 4002
  },
  "timestamp": 1640995200000
}
```

### 4.7 获取评论列表
- **接口说明**：获取动态的评论列表（树形结构）
- **请求路径**：`GET /contents/{contentId}/comments`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明   |
| --------- | ---- | ---- | ------ |
| contentId | int  | 是   | 动态ID |

- **查询参数**：

| 参数名 | 类型 | 必填 | 说明         |
| ------ | ---- | ---- | ------------ |
| page   | int  | 否   | 页码，默认1  |
| size   | int  | 否   | 每页数量，默认20 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 4002,
        "user": {
          "id": 2,
          "nickname": "李四",
          "avatarUrl": "http://example.com/avatar2.jpg"
        },
        "content": "评论内容",
        "parentId": null,
        "replies": [
          {
            "id": 4003,
            "user": {
              "id": 1,
              "nickname": "张三",
              "avatarUrl": "http://example.com/avatar.jpg"
            },
            "content": "回复内容",
            "parentId": 4002
          }
        ],
        "createdAt": "2024-03-10 15:00:00"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 20
  },
  "timestamp": 1640995200000
}
```

### 4.8 点赞/取消点赞
- **接口说明**：对动态或评论进行点赞或取消点赞
- **请求路径**：`POST /contents/{contentId}/like`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明   |
| --------- | ---- | ---- | ------ |
| contentId | int  | 是   | 内容ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "点赞成功",
  "data": {
    "liked": true,
    "count": 11
  },
  "timestamp": 1640995200000
}
```

### 4.9 获取点赞列表
- **接口说明**：获取给某个内容点赞的用户列表
- **请求路径**：`GET /contents/{contentId}/likes`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明   |
| --------- | ---- | ---- | ------ |
| contentId | int  | 是   | 内容ID |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 2,
      "nickname": "李四",
      "avatarUrl": "http://example.com/avatar2.jpg"
    }
  ],
  "timestamp": 1640995200000
}
```

---

## 5. 管理员功能模块（ADMIN）

### 5.1 获取用户列表（管理员）
- **接口说明**：管理员获取用户列表（分页）
- **请求路径**：`GET /admin/users`
- **查询参数**：

| 参数名   | 类型     | 必填 | 说明                     |
| -------- | -------- | ---- | ------------------------ |
| page     | int      | 否   | 页码，默认1              |
| size     | int      | 否   | 每页数量，默认20         |
| userType | UserType | 否   | 用户类型                 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 1,
        "email": "test@example.com",
        "nickname": "张三",
        "userType": 0,
        "createdAt": "2023-01-01 12:00:00"
      }
    ],
    "total": 1,
    "page": 1,
    "size": 20
  },
  "timestamp": 1640995200000
}
```

### 5.2 修改用户权限
- **接口说明**：管理员修改用户权限（设置/取消管理员）
- **请求路径**：`PUT /admin/users/{userId}/type`
- **路径参数**：

| 参数名 | 类型 | 必填 | 说明   |
| ------ | ---- | ---- | ------ |
| userId | int  | 是   | 用户ID |

- **请求参数**：

| 参数名   | 类型     | 必填 | 说明                     |
| -------- | -------- | ---- | ------------------------ |
| userType | UserType | 是   | 用户类型                 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "修改成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 5.3 管理订单
- **接口说明**：管理员强制修改订单状态
- **请求路径**：`PUT /admin/orders/{orderId}`
- **路径参数**：

| 参数名  | 类型 | 必填 | 说明   |
| ------- | ---- | ---- | ------ |
| orderId | int  | 是   | 订单ID |

- **请求参数**：

| 参数名 | 类型        | 必填 | 说明                                       |
| ------ | ----------- | ---- | ------------------------------------------ |
| status | OrderStatus | 是   | 订单状态                                   |

- **响应示例**：
```json
{
  "code": 200,
  "message": "修改成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 5.4 删除任意内容
- **接口说明**：管理员删除任意动态或评论
- **请求路径**：`DELETE /admin/contents/{contentId}`
- **路径参数**：

| 参数名    | 类型 | 必填 | 说明     |
| --------- | ---- | ---- | -------- |
| contentId | int  | 是   | 内容ID   |

- **响应示例**：
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null,
  "timestamp": 1640995200000
}
```

### 5.5 获取系统统计
- **接口说明**：管理员获取系统统计数据
- **请求路径**：`GET /admin/statistics`
- **响应示例**：
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "userCount": 100,
    "orderCount": 50,
    "contentCount": 200,
    "todayActiveUsers": 20
  },
  "timestamp": 1640995200000
}
```

---

## 6. 文件上传模块（FILE）

### 6.1 上传图片
- **接口说明**：通用图片上传接口
- **请求路径**：`POST /upload/image`
- **请求方式**：`multipart/form-data`
- **请求参数**：

| 参数名 | 类型 | 必填 | 说明     |
| ------ | ---- | ---- | -------- |
| image  | file | 是   | 图片文件 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "http://example.com/upload/image_123.jpg"
  },
  "timestamp": 1640995200000
}
```

### 6.2 上传视频
- **接口说明**：通用视频上传接口
- **请求路径**：`POST /upload/video`
- **请求方式**：`multipart/form-data`
- **请求参数**：

| 参数名 | 类型 | 必填 | 说明     |
| ------ | ---- | ---- | -------- |
| video  | file | 是   | 视频文件 |

- **响应示例**：
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "http://example.com/upload/video_123.mp4"
  },
  "timestamp": 1640995200000
}
```

---

## 7. 接口使用示例

### 7.1 前端调用示例（Vue 3 + Axios）

```javascript
// api.js - 封装所有API调用
import axios from 'axios'

const api = axios.create({
  baseURL: process.env.VUE_APP_API_URL || 'http://localhost:8080/api/v1',
  timeout: 10000
})

// 请求拦截器
api.interceptors.request.use(config => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// 响应拦截器
api.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      // Token过期，跳转登录
      router.push('/login')
    }
    return Promise.reject(error)
  }
)

// 用户相关API
export const userApi = {
  login(data) {
    return api.post('/auth/login', data)
  },
  
  register(data) {
    return api.post('/auth/register', data)
  },
  
  getUserInfo(userId) {
    return api.get(`/users/${userId}`)
  },
  
  updateUserInfo(userId, data) {
    return api.put(`/users/${userId}`, data)
  }
}

// 订单相关API
export const orderApi = {
  createOrder(data) {
    return api.post('/orders', data)
  },
  
  getOrders(params) {
    return api.get('/orders', { params })
  },
  
  getOrderDetail(orderId) {
    return api.get(`/orders/${orderId}`)
  },
  
  applyOrder(orderId, message) {
    return api.post(`/orders/${orderId}/apply`, { message })
  }
}

// 动态相关API
export const contentApi = {
  createContent(data) {
    return api.post('/contents', data)
  },
  
  getContents(params) {
    return api.get('/contents', { params })
  },
  
  likeContent(contentId) {
    return api.post(`/contents/${contentId}/like`)
  },
  
  commentContent(contentId, data) {
    return api.post(`/contents/${contentId}/comments`, data)
  }
}

// 文件上传
export const uploadApi = {
  uploadImage(formData) {
    return api.post('/upload/image', formData, {
      headers: { 'Content-Type': 'multipart/form-data' }
    })
  }
}
```

### 7.2 后端接口实现示例（Spring Boot）

```java
// OrderController.java
@RestController
@RequestMapping("/api/v1/orders")
@RequiredArgsConstructor
@Slf4j
public class OrderController {
    
    private final OrderService orderService;
    
    @PostMapping
    public ApiResponse<Long> createOrder(
            @Valid @RequestBody CreateOrderRequest request,
            @AuthenticationPrincipal UserDetails user) {
        Long userId = Long.parseLong(user.getUsername());
        Long orderId = orderService.createOrder(request, userId);
        return ApiResponse.success(orderId);
    }
    
    @GetMapping
    public ApiResponse<PageResult<OrderVO>> getOrders(
            @RequestParam(defaultValue = "1") Integer page,
            @RequestParam(defaultValue = "10") Integer size,
            @RequestParam(required = false) OrderStatus status,
            @RequestParam(required = false) ActivityType activityType) {
        
        OrderQuery query = OrderQuery.builder()
            .page(page)
            .size(size)
            .status(status)
            .activityType(activityType)
            .build();
            
        PageResult<OrderVO> result = orderService.getOrders(query);
        return ApiResponse.success(result);
    }
    
    @GetMapping("/{orderId}")
    public ApiResponse<OrderDetailVO> getOrderDetail(@PathVariable Long orderId) {
        OrderDetailVO detail = orderService.getOrderDetail(orderId);
        return ApiResponse.success(detail);
    }
}

// ApiResponse.java - 统一响应格式
@Data
@AllArgsConstructor
@NoArgsConstructor
public class ApiResponse<T> {
    private Integer code;
    private String message;
    private T data;
    private Long timestamp;
    
    public static <T> ApiResponse<T> success(T data) {
        return new ApiResponse<>(200, "成功", data, System.currentTimeMillis());
    }
    
    public static <T> ApiResponse<T> success(String message, T data) {
        return new ApiResponse<>(200, message, data, System.currentTimeMillis());
    }
    
    public static ApiResponse<?> error(Integer code, String message) {
        return new ApiResponse<>(code, message, null, System.currentTimeMillis());
    }
}

// 枚举定义示例
public enum ActivityType {
    BASKETBALL(0, "篮球"),
    BADMINTON(1, "羽毛球"),
    MEAL(2, "吃饭"),
    STUDY(3, "自习"),
    MOVIE(4, "看电影"),
    RUNNING(5, "跑步"),
    GAME(6, "游戏"),
    OTHER(7, "其他活动");
    
    private final int code;
    private final String desc;
    
    ActivityType(int code, String desc) {
        this.code = code;
        this.desc = desc;
    }
    
    public int getCode() { return code; }
    public String getDesc() { return desc; }
    
    public static ActivityType fromCode(int code) {
        for (ActivityType type : values()) {
            if (type.code == code) return type;
        }
        return OTHER;
    }
}
```

### 7.3 接口测试脚本（Shell）

```bash
#!/bin/bash
# api-test.sh

BASE_URL="http://localhost:8080/api/v1"

# 测试登录
echo "测试登录接口..."
curl -X POST $BASE_URL/auth/login \
  -H "Content-Type: application/json" \
  -d '{"identifier":"1120231148","password":"123456"}' \
  | python -m json.tool

echo -e "\n\n"

# 测试获取订单列表（需要先获取token）
TOKEN="YOUR_JWT_TOKEN"
echo "测试获取订单列表..."
curl -X GET "$BASE_URL/orders?page=1&size=10" \
  -H "Authorization: Bearer $TOKEN" \
  | python -m json.tool
```

### 7.4 Postman集合导入

```json
{
  "info": {
    "name": "校园约伴系统API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "用户认证",
      "item": [
        {
          "name": "用户登录",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"identifier\": \"1120231148\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080/api/v1"
    }
  ]
}
```

---

## 8. 附录

### 8.1 枚举值定义

#### 用户类型枚举（UserType）
| 值  | 说明     |
| --- | -------- |
| 0   | 普通用户 |
| 1   | 管理员   |

#### 活动类型枚举（ActivityType）
| 值  | 说明     |
| --- | -------- |
| 0   | 篮球     |
| 1   | 羽毛球   |
| 2   | 吃饭     |
| 3   | 自习     |
| 4   | 看电影   |
| 5   | 跑步     |
| 6   | 游戏     |
| 7   | 其他活动 |

#### 性别要求枚举（GenderType）
| 值  | 说明     |
| --- | -------- |
| 0   | 男       |
| 1   | 女       |
| 2   | 不限     |

#### 校区枚举（CampusType）
| 值  | 说明     |
| --- | -------- |
| 0   | 良乡校区 |
| 1   | 中关村校区 |
| 2   | 珠海校区 |
| 3   | 西山校区 |
| 4   | 其他校区 |

#### 订单状态枚举（OrderStatus）
| 值  | 说明       |
| --- | ---------- |
| 0   | 待匹配     |
| 1   | 进行中     |
| 2   | 已完成     |
| 3   | 已取消     |
| 4   | 已过期     |

#### 申请状态枚举（ApplyStatus）
| 值  | 说明       |
| --- | ---------- |
| 0   | 待审核     |
| 1   | 已通过     |
| 2   | 已拒绝     |
| 3   | 已取消     |

#### 内容类型枚举（ContentType）
| 值  | 说明       |
| --- | ---------- |
| 0   | 动态       |
| 1   | 评论       |

#### 媒体类型枚举（MediaType）
| 值  | 说明       |
| --- | ---------- |
| 0   | 纯文本     |
| 1   | 图片       |
| 2   | 视频       |

#### 内容状态枚举（ContentStatus）
| 值  | 说明       |
| --- | ---------- |
| 0   | 正常       |
| 1   | 已删除     |
| 2   | 待审核     |
| 3   | 审核不通过 |

### 8.2 错误码定义
| 错误码 | 说明           |
| ------ | -------------- |
| 1001   | 参数校验失败   |
| 1002   | 用户不存在     |
| 1003   | 密码错误       |
| 1004   | 无权限操作     |
| 1005   | 订单不存在     |
| 1006   | 动态不存在     |
| 1007   | 文件上传失败   |
| 1008   | 重复操作       |
| 1009   | 人数已满       |
| 1010   | 订单已过期     |

### 8.3 数据库表字段对照

#### orders表字段映射
| API字段        | 数据库字段      | 类型         |
| -------------- | --------------- | ------------ |
| activityType   | activity_type   | ActivityType |
| genderRequire  | gender_require  | GenderType   |
| campus         | campus          | CampusType   |
| location       | location        | string       |
| startTime      | start_time      | datetime     |
| note           | note            | string       |
| maxPeople      | max_people      | int          |
| currentPeople  | current_people  | int          |
| status         | status          | OrderStatus  |
| createdAt      | created_at      | datetime     |
| updatedAt      | updated_at      | datetime     |

#### users表字段映射
| API字段     | 数据库字段   | 类型     |
| ----------- | ------------ | -------- |
| avatarUrl   | avatar_url   | string   |
| userType    | user_type    | UserType |
| createdAt   | created_at   | datetime |
| updatedAt   | updated_at   | datetime |

---

## 9. 注意事项

### 9.1 安全性考虑
1. **密码安全**：密码必须加密存储，使用BCrypt或Argon2算法
2. **SQL注入防护**：使用参数化查询或ORM框架
3. **XSS防护**：对用户输入进行转义处理
4. **CSRF防护**：使用CSRF Token或SameSite Cookie
5. **文件上传**：限制文件类型和大小，重命名上传文件

### 9.2 性能优化
1. **分页查询**：所有列表接口必须支持分页
2. **数据库索引**：为常用查询字段建立索引
3. **缓存策略**：频繁查询的数据使用Redis缓存
4. **CDN加速**：图片和视频文件使用CDN分发
5. **连接池**：数据库和Redis使用连接池

### 9.3 可扩展性
1. **微服务拆分**：用户、订单、动态可拆分为独立服务
2. **消息队列**：异步处理邮件发送、消息通知等
3. **API版本控制**：为未来API变更预留空间
4. **监控告警**：集成Prometheus和Grafana监控

### 9.4 团队协作
1. **接口文档**：使用Swagger自动生成API文档
2. **代码规范**：统一代码风格，使用ESLint/Checkstyle
3. **Git流程**：采用Git Flow或GitHub Flow工作流
4. **Code Review**：所有代码合并前需经过Code Review
5. **持续集成**：配置GitHub Actions或Jenkins流水线

---

**文档版本**：v1.2
**最后更新**：2025年12月8日  
**维护团队**：校园约伴系统开发组  
**GitHub仓库**：https://github.com/suzhouriver7/mobile_internet_design-project
