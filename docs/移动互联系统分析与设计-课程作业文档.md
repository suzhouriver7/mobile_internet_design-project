# 校园约伴系统 - 移动互联系统分析与设计课程作业文档

> **课程**：移动互联系统分析与设计  
> **学校**：北京理工大学 计算机学院  
> **小组成员**：谷奕辰、孙健柏、伍奕涛、张元宏  
> **项目名称**：校园约伴系统（Campus Companion）  
> **文档版本**：v1.0  
> **日期**：2024年

---

## 目录

1. [项目可行性与需求分析](#1-项目可行性与需求分析)
2. [系统功能用例分析](#2-系统功能用例分析)
3. [功能分解树](#3-功能分解树)
4. [系统分析与设计](#4-系统分析与设计)
5. [开发计划](#5-开发计划)
6. [项目总结](#6-项目总结)

---

## 1. 项目可行性与需求分析

### 1.1 项目背景

在如今的大学生活中，同学们经常有约朋友伙伴一起出去进行**体育活动**、**聚餐**、**玩耍**的需求，但有时也有找不到合适的朋友一起出行的烦恼。传统的社交平台（如微信、QQ）虽然用户基数大，但缺乏针对性的约伴功能，导致用户在寻找活动伙伴时效率低下。

### 1.2 业务领域

**问题域（业务领域）**：校园学生生活、社交活动组织

**系统责任（系统功能）**：
- 用户账户管理与认证
- 活动预约订单管理
- 动态内容发布与社交互动
- AI智能助手服务
- 文件存储与管理
- 消息通知与交流

### 1.3 开发目标

我们的项目致力于开发一个**校园约伴系统平台**，不管是吃喝玩乐，还是体育运动，只要你想约别人一起进行某项活动，都可以通过我们的平台快速找到合适的伙伴。

系统核心功能包括：
- **预约活动模块**：用户可以发布预约订单，包括活动类型、时间、地点等信息，其他用户可以通过问询和接受订单来匹配
- **动态社区模块**：用户可以引用已完成的订单，发布活动结束后的心情、思考等动态内容，支持评论、点赞等社交互动
- **AI助手模块**：集成智谱AI，提供智能对话服务，帮助用户获取信息和建议

### 1.4 竞品分析

在北理工，最火的校园应用有贝塔驿站和bit101等，但这些平台都存在以下问题：
- 缺乏专门的约伴功能模块
- 信息流混乱，约伴帖子容易被其他无关内容淹没
- 没有针对性的匹配机制

我们的应用致力于解决这一有市场、有需求、大有可为的问题，提供专业的校园约伴服务。

### 1.5 系统边界

**系统内部**（需要开发的功能）：
- 用户注册、登录、密码找回
- 活动订单的创建、浏览、申请、管理
- 动态的发布、浏览、评论、点赞
- AI对话服务
- 用户信息管理
- 文件上传与管理

**系统外部**（不包含在本系统中）：
- 邮件服务（使用第三方SMTP服务器）
- AI服务（使用智谱AI开放平台）
- 文件存储（使用本地存储或云存储服务）

---

## 2. 系统功能用例分析

### 2.1 参与者（Actor）识别

#### 2.1.1 主要参与者

1. **普通用户（User）**
   - 描述：校园学生，使用系统进行约伴活动的主要用户
   - 职责：发布活动、申请活动、发布动态、浏览内容

2. **管理员（Admin）**
   - 描述：系统管理员，负责系统维护和内容管理
   - 职责：管理用户、审核内容、删除不当内容
   - 继承关系：Admin is_a User（管理员继承普通用户的所有权限，并拥有额外权限）

#### 2.1.2 外部系统参与者

3. **邮件系统（Email System）**
   - 描述：外部邮件服务系统
   - 职责：发送验证码邮件

4. **AI服务（AI Service）**
   - 描述：智谱AI开放平台
   - 职责：提供AI对话服务

### 2.2 用例定义

#### 2.2.1 用户认证模块

**UC-001：用户注册**
- 参与者：普通用户
- 前置条件：用户未登录
- 基本流程：
  1. 用户输入邮箱、密码、昵称等信息
  2. 系统发送验证码到用户邮箱
  3. 用户输入验证码
  4. 系统验证验证码正确性
  5. 系统创建用户账户
  6. 系统返回注册成功信息

**UC-002：用户登录**
- 参与者：普通用户、管理员
- 前置条件：用户已注册
- 基本流程：
  1. 用户输入邮箱/学号和密码
  2. 系统验证用户身份
  3. 系统生成JWT Token
  4. 系统返回Token和用户信息

**UC-003：忘记密码**
- 参与者：普通用户
- 前置条件：用户已注册但忘记密码
- 基本流程：
  1. 用户输入邮箱
  2. 系统发送验证码到邮箱（include UC-004）
  3. 用户输入验证码
  4. 系统验证验证码（include UC-005）
  5. 用户输入新密码
  6. 系统更新密码
  7. 系统返回成功信息

**UC-004：发送验证码**（被包含用例）
- 参与者：系统、邮件系统
- 用途：被注册、忘记密码等用例包含

**UC-005：验证验证码**（被包含用例）
- 参与者：系统
- 用途：被注册、忘记密码等用例包含

#### 2.2.2 用户管理模块

**UC-006：查看个人信息**
- 参与者：普通用户、管理员
- 前置条件：用户已登录
- 基本流程：
  1. 用户请求查看个人信息
  2. 系统返回用户详细信息

**UC-007：编辑个人信息**
- 参与者：普通用户、管理员
- 前置条件：用户已登录
- 基本流程：
  1. 用户修改昵称、签名等信息
  2. 系统验证数据有效性
  3. 系统更新用户信息
  4. 系统返回更新结果

**UC-008：上传头像**
- 参与者：普通用户、管理员
- 前置条件：用户已登录
- 基本流程：
  1. 用户选择图片文件
  2. 系统验证文件格式和大小
  3. 系统保存文件
  4. 系统更新用户头像URL
  5. 系统返回上传结果

**UC-009：修改密码**
- 参与者：普通用户、管理员
- 前置条件：用户已登录
- 基本流程：
  1. 用户输入原密码和新密码
  2. 系统验证原密码正确性
  3. 系统更新密码
  4. 系统返回成功信息

#### 2.2.3 活动预约模块

**UC-010：发布活动订单**
- 参与者：普通用户
- 前置条件：用户已登录
- 基本流程：
  1. 用户填写活动信息（类型、时间、地点、人数等）
  2. 系统验证数据有效性
  3. 系统创建活动订单
  4. 系统返回订单ID

**UC-011：浏览活动列表**
- 参与者：普通用户、管理员
- 前置条件：无
- 基本流程：
  1. 用户请求活动列表（可选：筛选条件）
  2. 系统根据条件查询活动
  3. 系统返回活动列表

**UC-012：查看活动详情**
- 参与者：普通用户、管理员
- 前置条件：无
- 基本流程：
  1. 用户选择活动
  2. 系统返回活动详细信息（包括申请列表、消息等）

**UC-013：申请加入活动**
- 参与者：普通用户
- 前置条件：用户已登录，活动状态为待匹配
- 基本流程：
  1. 用户选择活动并点击申请
  2. 系统检查用户是否已申请
  3. 系统创建申请记录
  4. 系统返回申请结果

**UC-014：管理活动申请**（扩展用例）
- 参与者：普通用户（订单发布者）
- 前置条件：用户已登录，是活动发布者
- 基本流程：
  1. 用户查看申请列表
  2. 用户审核申请（通过/拒绝）
  3. 系统更新申请状态
  4. 系统更新活动参与人数

**UC-015：发送活动消息**
- 参与者：普通用户
- 前置条件：用户已登录，已申请或已参与活动
- 基本流程：
  1. 用户在活动聊天界面输入消息
  2. 系统保存消息
  3. 系统返回发送结果

**UC-016：查看活动消息**
- 参与者：普通用户
- 前置条件：用户已登录，已申请或已参与活动
- 基本流程：
  1. 用户请求活动消息列表
  2. 系统返回消息列表

**UC-017：管理活动订单**（扩展用例）
- 参与者：普通用户（订单发布者）
- 前置条件：用户已登录，是活动发布者
- 基本流程：
  1. 用户修改活动信息
  2. 系统更新订单
  3. 或：用户取消活动
  4. 系统更新订单状态为已取消

#### 2.2.4 动态社区模块

**UC-018：发布动态**
- 参与者：普通用户
- 前置条件：用户已登录
- 基本流程：
  1. 用户输入动态内容（可选：关联订单、上传图片/视频）
  2. 系统验证内容有效性
  3. 系统保存动态
  4. 系统返回动态ID

**UC-019：浏览动态列表**
- 参与者：普通用户、管理员
- 前置条件：无
- 基本流程：
  1. 用户请求动态列表
  2. 系统返回动态列表（分页）

**UC-020：查看动态详情**
- 参与者：普通用户、管理员
- 前置条件：无
- 基本流程：
  1. 用户选择动态
  2. 系统返回动态详细信息（包括评论列表）

**UC-021：评论动态**
- 参与者：普通用户
- 前置条件：用户已登录
- 基本流程：
  1. 用户在动态详情页输入评论
  2. 系统保存评论
  3. 系统返回评论信息

**UC-022：点赞动态**
- 参与者：普通用户
- 前置条件：用户已登录
- 基本流程：
  1. 用户点击点赞按钮
  2. 系统检查是否已点赞
  3. 如果未点赞，系统创建点赞记录；如果已点赞，系统删除点赞记录
  4. 系统返回操作结果

#### 2.2.5 AI助手模块

**UC-023：AI对话**
- 参与者：普通用户
- 前置条件：用户已登录
- 基本流程：
  1. 用户输入对话内容
  2. 系统调用AI服务（include UC-024）
  3. 系统返回AI回复
  4. 系统保存对话历史

**UC-024：调用AI服务**（被包含用例）
- 参与者：系统、AI服务
- 用途：被AI对话用例包含

#### 2.2.6 管理员模块

**UC-025：管理用户**（扩展用例）
- 参与者：管理员
- 前置条件：管理员已登录
- 基本流程：
  1. 管理员查看用户列表
  2. 管理员执行操作（禁用/启用用户）

**UC-026：删除内容**（扩展用例）
- 参与者：管理员
- 前置条件：管理员已登录
- 基本流程：
  1. 管理员选择动态或订单
  2. 管理员执行删除操作
  3. 系统标记内容为已删除

### 2.3 用例图

系统的用例图分为以下几个模块：

1. **用户认证系统用例图**（参考：`docs/DemandAnalysis/usage_image/账号系统.drawio.png`）
   - 参与者：普通用户
   - 用例：注册、登录、忘记密码、发送验证码、验证验证码

2. **预约订单系统用例图**（参考：`docs/DemandAnalysis/usage_image/预约订单系统.drawio.png`）
   - 参与者：普通用户
   - 用例：发布订单、浏览订单、申请加入、管理申请、发送消息等

3. **动态系统用例图**（参考：`docs/DemandAnalysis/usage_image/动态系统.drawio.png`）
   - 参与者：普通用户
   - 用例：发布动态、浏览动态、评论、点赞

4. **AI应用用例图**（参考：`docs/DemandAnalysis/usage_image/AI应用.drawio.png`）
   - 参与者：普通用户、AI服务
   - 用例：AI对话、调用AI服务

### 2.4 用例关系说明

**包含关系（Include）**：
- UC-003 包含 UC-004（忘记密码包含发送验证码）
- UC-003 包含 UC-005（忘记密码包含验证验证码）
- UC-001 包含 UC-004（注册包含发送验证码）
- UC-001 包含 UC-005（注册包含验证验证码）
- UC-023 包含 UC-024（AI对话包含调用AI服务）

**扩展关系（Extend）**：
- UC-017 扩展 UC-010（管理活动订单扩展发布活动订单）
- UC-014 扩展 UC-012（管理活动申请扩展查看活动详情）
- UC-025 扩展 UC-006（管理用户扩展查看个人信息）
- UC-026 扩展 UC-012、UC-020（删除内容扩展查看详情）

**继承关系（Generalization）**：
- 管理员（Admin）继承普通用户（User）的所有用例

---

## 3. 功能分解树

### 3.1 功能清单整理

通过小组成员头脑风暴，我们确定了以下功能清单：

#### 3.1.1 用户认证功能
- 用户注册（邮箱验证码注册）
- 用户登录（邮箱/学号登录）
- 忘记密码（三步流程）
- 发送验证码
- 验证验证码

#### 3.1.2 用户管理功能
- 查看个人信息
- 编辑个人信息
- 上传头像
- 修改密码
- 查看我的活动
- 查看我的动态

#### 3.1.3 活动预约功能
- 发布活动订单
- 浏览活动列表
- 筛选活动（按类型、校区、状态）
- 查看活动详情
- 申请加入活动
- 查看活动申请列表
- 审核活动申请（通过/拒绝）
- 发送活动消息
- 查看活动消息列表
- 修改活动信息
- 取消活动
- 接受活动订单

#### 3.1.4 动态社区功能
- 发布动态（文字、图片、视频）
- 浏览动态列表
- 查看动态详情
- 评论动态
- 回复评论
- 点赞/取消点赞动态
- 点赞/取消点赞评论
- 查看点赞列表

#### 3.1.5 AI助手功能
- AI对话
- 系统提示对话

#### 3.1.6 管理员功能
- 查看用户列表
- 禁用/启用用户
- 删除动态
- 删除订单

#### 3.1.7 系统功能
- 文件上传
- 图片/视频存储
- 消息通知

### 3.2 功能分解树

```
校园约伴系统
│
├── 用户认证模块
│   ├── 注册功能
│   │   ├── 邮箱验证码注册
│   │   └── 验证码发送与验证
│   ├── 登录功能
│   │   ├── 邮箱登录
│   │   └── 学号登录
│   └── 密码管理
│       ├── 忘记密码
│       │   ├── 验证邮箱
│       │   ├── 验证验证码
│       │   └── 重置密码
│       └── 修改密码
│
├── 用户管理模块
│   ├── 个人信息管理
│   │   ├── 查看个人信息
│   │   ├── 编辑个人信息
│   │   └── 上传头像
│   └── 个人数据查看
│       ├── 我的活动
│       └── 我的动态
│
├── 活动预约模块
│   ├── 活动发布
│   │   ├── 创建活动订单
│   │   ├── 修改活动信息
│   │   └── 取消活动
│   ├── 活动浏览
│   │   ├── 浏览活动列表
│   │   ├── 筛选活动（类型、校区、状态）
│   │   └── 查看活动详情
│   ├── 活动申请
│   │   ├── 申请加入活动
│   │   ├── 查看申请列表
│   │   └── 审核申请（通过/拒绝）
│   ├── 活动交流
│   │   ├── 发送活动消息
│   │   └── 查看活动消息
│   └── 活动接受
│       └── 接受活动订单
│
├── 动态社区模块
│   ├── 动态发布
│   │   ├── 发布文字动态
│   │   ├── 发布图片动态
│   │   └── 发布视频动态
│   ├── 动态浏览
│   │   ├── 浏览动态列表
│   │   └── 查看动态详情
│   ├── 动态互动
│   │   ├── 评论动态
│   │   ├── 回复评论
│   │   ├── 点赞动态
│   │   └── 点赞评论
│   └── 点赞管理
│       └── 查看点赞列表
│
├── AI助手模块
│   └── AI对话
│       ├── 普通对话
│       └── 系统提示对话
│
├── 管理员模块
│   ├── 用户管理
│   │   ├── 查看用户列表
│   │   └── 禁用/启用用户
│   └── 内容管理
│       ├── 删除动态
│       └── 删除订单
│
└── 系统支撑模块
    ├── 文件管理
    │   ├── 文件上传
    │   └── 文件存储
    └── 消息通知
        └── 邮件发送
```

### 3.3 功能依赖关系

**核心功能**（必须先实现）：
1. 用户认证模块（用户注册、登录）
2. 用户管理模块（基础信息管理）
3. 活动预约模块（活动发布、浏览、申请）

**依赖核心功能的功能**：
1. 动态社区模块（依赖用户认证）
2. AI助手模块（依赖用户认证）
3. 管理员模块（依赖用户认证和用户管理）

**独立功能**（可以并行开发）：
1. 文件管理（相对独立，可并行开发）

---

## 4. 系统分析与设计

### 4.1 系统架构设计

#### 4.1.1 整体架构

系统采用**前后端分离架构**，遵循**领域驱动设计（DDD）**思想，具体架构如下：

```
┌─────────────────────────────────────────────────────────┐
│                      客户端层                             │
├──────────────┬──────────────┬──────────────────────────┤
│  移动端App    │  Web前端     │      (可选)微信小程序      │
│  (uni-app)   │  (Vue 3)     │                          │
└──────┬───────┴──────┬───────┴──────────┬───────────────┘
       │              │                  │
       └──────────────┼──────────────────┘
                      │
                      │ HTTP/HTTPS
                      │ RESTful API
                      │
┌─────────────────────┴───────────────────────────────────┐
│                    API网关层                              │
│              (Spring Boot + Spring Security)             │
└─────────────────────┬───────────────────────────────────┘
                      │
┌─────────────────────┴───────────────────────────────────┐
│                    应用服务层                             │
├──────────────┬──────────────┬──────────────────────────┤
│  用户服务     │  活动服务     │   动态服务    │  AI服务    │
│ (AuthService)│(OrderService)│(ContentService)│(AIService)│
└──────┬───────┴──────┬───────┴──────┬────────┴───────────┘
       │              │              │          │
┌──────┴──────────────┴──────────────┴──────────┴──────────┐
│                      数据访问层                            │
│              (Spring Data JPA / Hibernate)                │
└─────────────────────┬───────────────────────────────────┘
                      │
┌─────────────────────┴───────────────────────────────────┐
│                      数据存储层                            │
├──────────────┬──────────────┬──────────────────────────┤
│   MySQL数据库 │   文件存储    │     外部服务              │
│              │  (本地/云存储) │  (邮件服务/AI服务)        │
└──────────────┴──────────────┴──────────────────────────┘
```

#### 4.1.2 技术架构

**后端技术栈**：
- **框架**：Spring Boot 4.0.0
- **Java版本**：JDK 21
- **ORM**：Spring Data JPA + Hibernate
- **数据库**：MySQL 8.0
- **安全框架**：Spring Security + JWT
- **邮件服务**：Spring Mail
- **HTTP客户端**：Apache HttpClient（用于调用AI服务）
- **构建工具**：Maven

**前端技术栈**：
- **移动端**：uni-app (Vue 3) + Vuex 4
- **Web端**：Vue 3 + Vite + Element Plus + Pinia

### 4.2 领域驱动设计（DDD）

#### 4.2.1 限界上下文（Bounded Context）划分

根据DDD理论，我们将系统划分为以下限界上下文：

1. **用户上下文（User Context）**
   - 核心实体：User
   - 职责：用户认证、用户信息管理
   - 边界：处理所有与用户账户相关的业务

2. **活动上下文（Order Context）**
   - 核心实体：Order、OrderApply、OrderMessage、OrderAccept
   - 职责：活动订单的创建、申请、交流、接受
   - 边界：处理所有与活动预约相关的业务

3. **内容上下文（Content Context）**
   - 核心实体：Post、PostMedia、PostLike
   - 职责：动态发布、评论、点赞
   - 边界：处理所有与内容发布和社交互动相关的业务

4. **AI上下文（AI Context）**
   - 核心实体：ChatMessage（模型对象）
   - 职责：AI对话服务
   - 边界：处理AI相关的业务逻辑

5. **共享内核（Shared Kernel）**
   - 文件服务
   - 验证码服务
   - 通用工具类

#### 4.2.2 领域模型设计

**用户领域模型**：
```
User (聚合根)
├── uid (值对象)
├── email (值对象)
├── password (值对象，加密)
├── nickname (值对象)
├── avatarUrl (值对象)
├── signature (值对象)
├── userType (枚举)
└── userStatus (枚举)
```

**活动领域模型**：
```
Order (聚合根)
├── oid (值对象)
├── user (实体引用)
├── activityType (枚举)
├── genderRequire (枚举)
├── campus (枚举)
├── location (值对象)
├── startTime (值对象)
├── note (值对象)
├── maxPeople (值对象)
├── currentPeople (值对象)
├── status (枚举)
├── OrderApply[] (实体集合)
├── OrderMessage[] (实体集合)
└── OrderAccept (实体)
```

**内容领域模型**：
```
Post (聚合根)
├── pid (值对象)
├── user (实体引用)
├── parentPost (实体引用，可为空)
├── order (实体引用，可为空)
├── type (枚举)
├── content (值对象)
├── hasMedia (枚举)
├── status (枚举)
├── PostMedia[] (实体集合)
└── PostLike[] (实体集合)
```

### 4.3 静态模型设计

#### 4.3.1 包结构设计

**后端包结构**：
```
dev.campuscompanionbackend
├── config/              # 配置类
│   ├── SecurityConfig
│   ├── WebMvcConfig
│   └── HttpClientConfig
├── controller/          # 控制器层（REST API）
│   ├── AuthController
│   ├── UserController
│   ├── OrderController
│   ├── ContentController
│   ├── ZhipuController (AI)
│   └── FileController
├── service/             # 服务层（业务逻辑）
│   ├── AuthService
│   ├── UserService
│   ├── OrderService
│   ├── ContentService
│   └── AIService
├── repository/          # 数据访问层
│   ├── UserRepository
│   ├── OrderRepository
│   ├── PostRepository
│   └── ...
├── entity/              # 实体类（领域模型）
│   ├── User
│   ├── Order
│   ├── Post
│   └── ...
├── dto/                 # 数据传输对象
│   ├── request/
│   └── response/
├── enums/               # 枚举类
│   ├── UserType
│   ├── ActivityType
│   ├── OrderStatus
│   └── ...
├── exception/           # 异常处理
│   ├── BusinessException
│   └── ErrorCode
└── utils/               # 工具类
    └── JwtUtil
```

#### 4.3.2 核心类图

**用户模块类图**：
```
┌─────────────────┐
│   User (实体)    │
├─────────────────┤
│ + uid: Long     │
│ + email: String │
│ + password: ... │
│ + nickname: ... │
│ + avatarUrl: ...│
│ + userType: ... │
└────────┬────────┘
         │
         │ 1
         │
┌────────┴────────┐      ┌──────────────┐
│ UserRepository  │─────>│  UserService │
│  (接口)         │      │  (接口)      │
└─────────────────┘      └──────┬───────┘
                                 │
                          ┌──────┴───────┐
                          │ AuthController│
                          │ UserController│
                          └──────────────┘
```

**活动模块类图**：
```
┌─────────────────┐
│  Order (实体)    │
├─────────────────┤
│ + oid: Long     │
│ + user: User    │
│ + activityType  │
│ + status: ...   │
└────────┬────────┘
         │ 1
         │
         │ *          ┌──────────────┐
         └───────────>│ OrderApply   │
                      │ OrderMessage │
                      │ OrderAccept  │
                      └──────────────┘
```

（详细的类图设计可以参考实际的代码实现）

### 4.4 动态模型设计

#### 4.4.1 用户注册时序图

```
用户        前端        后端Controller    后端Service    邮件系统    数据库
 │           │              │                │             │          │
 │──注册请求─>│              │                │             │          │
 │           │──POST /register──────────────>│             │          │
 │           │              │──register()───>│             │          │
 │           │              │                │──生成验证码─>│          │
 │           │              │                │             │──发送邮件>│
 │           │              │                │<──验证码ID───│          │
 │           │              │<──返回验证码ID──│             │          │
 │<──验证码ID─│              │                │             │          │
 │──输入验证码>│              │                │             │          │
 │           │──POST /verify-code───────────>│             │          │
 │           │              │──verifyCode()─>│             │          │
 │           │              │                │──查询验证码─>│          │
 │           │              │                │<──验证码记录─│          │
 │           │              │                │──验证正确性  │          │
 │           │              │                │──创建用户────┼─────────>│
 │           │              │<──返回用户信息──│<──用户ID────┼──────────│
 │<──注册成功─│<──返回成功───│                │             │          │
```

#### 4.4.2 活动申请时序图

```
申请用户   前端     后端Controller   后端Service    数据库    订单发布者
  │        │           │                │            │          │
  │─申请加入>│           │                │            │          │
  │        │─POST /apply──────────────>│            │          │
  │        │           │──apply()──────>│            │          │
  │        │           │                │──查询订单───┼─────────>│
  │        │           │                │<──订单信息──┼──────────│
  │        │           │                │──检查状态   │          │
  │        │           │                │──创建申请───┼─────────>│
  │        │           │                │<──申请ID────┼──────────│
  │        │           │<──返回申请结果──│            │          │
  │<──申请成功│<──返回成功─│                │            │          │
  │        │           │                │            │          │
  │        │        (订单发布者查看申请)  │            │          │
  │        │           │                │            │          │
  │        │<────────GET /applications──│            │          │
  │        │           │──getApplications()───────>│            │
  │        │           │                │──查询申请───┼─────────>│
  │        │           │<──返回申请列表──│<──申请列表──┼──────────│
  │        │<──申请列表─│                │            │          │
  │        │           │                │            │          │
  │        │<─────────审核申请───────────│            │          │
  │        │           │──approve()─────>│            │          │
  │        │           │                │──更新申请───┼─────────>│
  │        │           │                │──更新订单───┼─────────>│
  │        │           │<──返回结果──────│            │          │
  │<──审核结果│<──返回成功─│                │            │          │
```

#### 4.4.3 活动状态转换图

```
     [创建订单]
         │
         ▼
    ┌─────────┐
    │ PENDING │ (待匹配)
    └────┬────┘
         │
         │ 有人申请
         ▼
┌────────────────┐
│ IN_PROGRESS    │ (进行中)
│ (审核通过)     │
└────┬───────────┘
     │
     │ 活动开始
     ▼
┌─────────────┐      ┌──────────┐
│ COMPLETED   │      │ CANCELLED│ (已取消)
│ (已完成)    │      └──────────┘
└────┬────────┘
     │
     │ 过期
     ▼
┌──────────┐
│ EXPIRED  │ (已过期)
└──────────┘
```

### 4.5 数据库设计

系统采用关系型数据库MySQL，具体设计详见：`docs/SystemAnalysis/数据库模型设计.md`

**核心表结构**：
- `users` - 用户表
- `orders` - 活动订单表
- `order_apply` - 活动申请表
- `order_messages` - 活动消息表
- `order_accept` - 活动接受表
- `posts` - 动态/评论表
- `post_media` - 动态媒体表
- `post_likes` - 点赞表
- `verify_code_record` - 验证码记录表

### 4.6 API设计

系统采用RESTful API设计风格，详细接口文档见：`docs/SystemAnalysis/接口文档.md`

**主要API模块**：
- `/api/v1/auth` - 认证相关接口
- `/api/v1/users` - 用户管理接口
- `/api/v1/orders` - 活动管理接口
- `/api/v1/contents` - 动态管理接口
- `/api/v1/ai` - AI服务接口
- `/api/v1/files` - 文件上传接口
- `/api/v1/verify` - 验证码接口

---

## 5. 开发计划

### 5.1 功能优先级划分

#### 5.1.1 核心功能（第一阶段）

1. **用户认证模块**
   - 用户注册（邮箱验证码）
   - 用户登录（JWT认证）
   - 忘记密码

2. **用户管理模块**
   - 查看个人信息
   - 编辑个人信息
   - 上传头像

3. **活动预约模块**
   - 发布活动订单
   - 浏览活动列表
   - 查看活动详情
   - 申请加入活动

#### 5.1.2 重要功能（第二阶段）

4. **活动管理功能**
   - 审核活动申请
   - 活动消息交流
   - 修改/取消活动

5. **动态社区模块**
   - 发布动态
   - 浏览动态列表
   - 查看动态详情
   - 评论动态
   - 点赞功能

#### 5.1.3 增强功能（第三阶段）

6. **AI助手模块**
   - AI对话功能

7. **管理员功能**
   - 用户管理
   - 内容管理

### 5.2 开发顺序安排

**Week 1-2：项目搭建与核心功能开发**
- 项目初始化（后端、前端、数据库）
- 用户认证模块开发
- 用户管理模块开发

**Week 3-4：活动功能开发**
- 活动预约模块开发（发布、浏览、申请）
- 活动管理功能开发（审核、消息、修改）

**Week 5-6：动态功能开发**
- 动态社区模块开发
- 评论、点赞功能

**Week 7：AI功能与管理员功能**
- AI助手模块集成
- 管理员功能开发

**Week 8：测试与优化**
- 功能测试
- Bug修复
- 性能优化
- 文档完善

### 5.3 分工方式

#### 5.3.1 采用"水平分割"与"垂直分割"相结合的方式

**第一阶段（水平分割）**：
- **后端开发**：2人负责
  - 成员A：用户认证模块、用户管理模块
  - 成员B：活动预约模块、动态社区模块
- **前端开发**：2人负责
  - 成员C：移动端App开发
  - 成员D：Web前端开发

**第二阶段（垂直分割 - 按限界上下文）**：
- **用户上下文**：成员A
- **活动上下文**：成员B
- **内容上下文**：成员C
- **AI上下文**：成员D

**组长职责**：
- 代码仓库管理（Git）
- 代码审查与合并
- 进度跟踪
- 团队协调

#### 5.3.2 开发规范

1. **代码管理**：
   - 使用Git进行版本控制
   - 采用Git Flow工作流
   - 功能开发使用feature分支
   - 代码合并前必须经过代码审查

2. **接口约定**：
   - 前后端提前约定API接口规范
   - 使用Mock Server进行并行开发
   - 接口文档及时更新

3. **测试策略**：
   - 单元测试（Service层）
   - 集成测试（Controller层）
   - 接口测试（Postman/自动化测试）

### 5.4 迭代开发流程

采用**迭代式开发**方式，每个功能模块遵循以下流程：

1. **需求分析** → 明确功能需求
2. **设计** → 数据库设计、API设计、UI设计
3. **开发** → 编码实现
4. **测试** → 功能测试、集成测试
5. **集成** → 合并到主分支
6. **部署** → 部署到测试环境

每个迭代周期为1-2周，每个迭代完成后进行代码审查和测试。

### 5.5 里程碑计划

| 里程碑 | 时间 | 交付物 |
|--------|------|--------|
| M1：项目启动 | Week 1 | 项目计划、需求文档、架构设计 |
| M2：核心功能完成 | Week 4 | 用户认证、用户管理、活动发布与浏览 |
| M3：主要功能完成 | Week 6 | 活动管理、动态社区功能 |
| M4：全部功能完成 | Week 7 | AI功能、管理员功能 |
| M5：项目交付 | Week 8 | 完整系统、测试报告、文档 |

---

## 6. 项目总结

### 6.1 项目完成情况

✅ **已完成功能**：
- 用户认证系统（注册、登录、忘记密码）
- 用户管理系统（信息管理、头像上传）
- 活动预约系统（发布、浏览、申请、管理、消息）
- 动态社区系统（发布、浏览、评论、点赞）
- AI助手系统（智能对话）
- 管理员系统（用户管理、内容管理）
- 文件上传系统

✅ **技术实现**：
- 后端：Spring Boot + Spring Security + JWT + MySQL
- 移动端：uni-app (Vue 3) + Vuex
- Web前端：Vue 3 + Vite + Element Plus + Pinia
- 前后端完全分离，RESTful API设计

✅ **文档完成**：
- 需求分析文档
- 系统设计文档
- 数据库设计文档
- API接口文档
- 项目README文档

### 6.2 技术亮点

1. **架构设计**：
   - 前后端分离架构
   - DDD领域驱动设计思想
   - RESTful API设计
   - 分层架构（Controller-Service-Repository）

2. **安全性**：
   - JWT Token认证
   - 密码加密存储
   - Spring Security安全框架
   - 输入验证与异常处理

3. **可扩展性**：
   - 模块化设计
   - 清晰的代码结构
   - 易于维护和扩展

4. **用户体验**：
   - 多端支持（移动端、Web端）
   - 响应式设计
   - 友好的错误提示

### 6.3 遇到的挑战与解决方案

1. **前后端并行开发**：
   - 挑战：前后端开发进度不同步
   - 解决方案：使用Mock Server，提前约定API接口规范

2. **多端适配**：
   - 挑战：移动端和Web端需要适配不同的交互方式
   - 解决方案：使用uni-app实现多端统一，Web端独立开发

3. **状态管理**：
   - 挑战：复杂的状态管理（用户状态、活动状态等）
   - 解决方案：使用Vuex（移动端）和Pinia（Web端）进行状态管理

4. **AI服务集成**：
   - 挑战：第三方AI服务的集成和调用
   - 解决方案：使用Apache HttpClient封装AI服务调用，统一异常处理

### 6.4 经验总结

1. **需求分析的重要性**：
   - 在开发前充分讨论需求，绘制用例图和功能分解树，有助于明确系统边界和功能范围

2. **架构设计先行**：
   - 先进行架构设计，确定技术栈和模块划分，再开始编码，可以避免后期大规模重构

3. **接口约定**：
   - 前后端提前约定API接口规范，使用Mock Server可以大大提高开发效率

4. **迭代开发**：
   - 采用迭代式开发，先实现核心功能，再逐步完善，可以更快看到成果

5. **代码管理**：
   - 使用Git进行版本控制，采用合适的工作流，可以有效管理代码和团队协作

### 6.5 未来改进方向

1. **性能优化**：
   - 引入Redis缓存
   - 数据库查询优化
   - 图片CDN加速

2. **功能增强**：
   - 推送通知
   - 实时聊天（WebSocket）
   - 活动推荐算法

3. **微服务化**：
   - 将单体应用拆分为微服务
   - 服务注册与发现
   - 负载均衡

4. **监控与运维**：
   - 日志系统
   - 性能监控
   - 自动化部署

---

## 附录

### A. 参考资料

- Spring Boot官方文档：https://spring.io/projects/spring-boot
- Vue 3官方文档：https://vuejs.org/
- uni-app官方文档：https://uniapp.dcloud.io/
- DDD领域驱动设计相关书籍和资料

### B. 项目仓库

- 项目代码：Git仓库地址（如有）
- 文档目录：`docs/`

### C. 联系方式

- 项目组：北京理工大学2023级计算机学院
- 小组成员：谷奕辰、孙健柏、伍奕涛、张元宏

---

**文档结束**

